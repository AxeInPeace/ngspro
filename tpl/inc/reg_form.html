<form class="modal fade" method="post" action="{% url 'registration' %}" id="reg_form">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
        <h4 class="modal-title">Регистрация</h4>
      </div>
      <div class="modal-body">
        <input id="username" name="username" required="required" type="text" placeholder="myusername"/>
	<input id="password" name="password" required="required" type="password" placeholder="eg. X8df!90EO" />
	<input id="email" name="email" required="required" type="email" placeholder="email@email.ru" />
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
        <input type="submit" class="btn btn-primary" value="Войти"/>
	{% csrf_token %}
      </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</form><!-- /.modal -->
<script>
$( "#reg_form" ).on('submit', function( event ) {
  event.preventDefault();
  if ($("#reg_form").find(".alert")) {
    $("#reg_form").find(".alert").remove();
    var no_timer = true;
  }
  $.post('/reg/', $('#reg_form').serialize(), function(event) {
    $("#reg_form").find(".modal-header").append("<div class=\"alert alert-success\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>Еще секундочку!</div>")
  })
  .fail(function () {
    $("#reg_form").find(".modal-header").append("<div class=\"alert alert-danger\" role=\"alert\"><button type=\"button\" class=\"close\" data-dismiss=\"alert\" aria-label=\"Close\"><span aria-hidden=\"true\">&times;</span></button>Ой! Что-то пошло не так! :(</div>")
  });
  if (!no_timer) {
    setTimeout(function() {
      $("div.alert").remove();
    }, 5000);
  }
});
</script>
